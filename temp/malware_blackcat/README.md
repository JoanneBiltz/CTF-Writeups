# BlackCat (malware, 211 solves, 50 points)

## Introduction

<p align="left">
  <img height=400 img src=./readme_assets/blackcat-challenge.PNG/>
</p>

## Solution

<p align="left">
  <img height=300 img src=./readme_assets/NOTE.png/>
</p>

With a little googling I learned about `chosen plaintext attacks`. In the files we are given there is a folder with the victim's encrypted files.

I opened the cat png image and copied the first line of hex, converted to binary and xored it against the first line of hex from the encrypted png.

`10001001010100000100111001000111000011010000101000011010000010100000000000000000000000000000110101001001010010000100010001010010 cat png`

`11101010001111110011110100101010011000100110100001110101011000110110001101101111011100110110000000100110001010100010101100111011 encrypted png`

Then I xored the results with the hex from the flag file.

`00101000000010100001011000011101000001100000110000001000010010010000111000010110010100110000101100000011000000110000100001001001 = flag.txt`

The result 01001011011001010110010101110000011010010110111001100111001000000110110101111001001000000110011001101100011000010110011100100000 converts to `Keeping my flag`. That is not the flag so I have to figure out what I did wrong. The flag must be longer.

<p align="left">
  <img height=300 img src=./readme_assets/blackcat-flag.PNG/>
</p>

In the end I had to take the the entire flag hex and xor it against the result of the first `xor`, but repeat the first `xor` to make it as long as the flag.

## Flag

**`flag{092744b55420033c5eb9d609eac5e823}`**

## Tools

- `xor`
- `xxd`
