# Batchfuscation (malware, 275 solves, 50 points)

## Introduction

<p align="left">
  <img height=400 img src=./readme_assets/batch-challenge.PNG/>
</p>

## Solution

This was a real slog to get through. The file you are given is a heavily obfuscated batch file that you have to de-obfuscate by hand. Open in notepad and use copy/replace to get all values.

Here is a small sample of the obfuscated text. 

```
@echo off
set bdevq=set
%bdevq% grfxdh= 
%bdevq%%grfxdh%mbbzmk==
%bdevq%%grfxdh%xeegh%mbbzmk%/
%bdevq%%grfxdh%jeuudks%mbbzmk%a
%bdevq%%grfxdh%rbiky%mbbzmk%c
%bdevq%%grfxdh%wzirk%mbbzmk%m
%bdevq%%grfxdh%naikpbo%mbbzmk%d
%bdevq%%grfxdh%ltevposie%mbbzmk%e
%bdevq%%grfxdh%uqcqswo%mbbzmk%x
%bdevq%%grfxdh%zvipzis%mbbzmk%i
%bdevq%%grfxdh%kquqjy%mbbzmk%t
%bdevq%%grfxdh%kmgnxdhqb%mbbzmk% 
%bdevq%%grfxdh%%xeegh%%jeuudks%%grfxdh%bpquuu%mbbzmk%4941956 %% 4941859
%rbiky%%wzirk%%naikpbo%%kmgnxdhqb%%xeegh%%rbiky%%kmgnxdhqb%%ltevposie%%uqcqswo%%zvipzis%%kquqjy%%kmgnxdhqb%%bpquuu%
%bdevq%%grfxdh%grtoy%mbbzmk%%=exitcodeAscii%
%bdevq%%grfxdh%%xeegh%%jeuudks%%grfxdh%fqumc%mbbzmk%9273642 %% 9273544
%rbiky%%wzirk%%naikpbo%%kmgnxdhqb%%xeegh%%rbiky%%kmgnxdhqb%%ltevposie%%uqcqswo%%zvipzis%%kquqjy%%kmgnxdhqb%%fqumc%
%bdevq%%grfxdh%kbhoesxh%mbbzmk%%=exitcodeAscii%
%bdevq%%grfxdh%%xeegh%%jeuudks%%grfxdh%uhtsvvtj%mbbzmk%9196704 %% 9196605
%rbiky%%wzirk%%naikpbo%%kmgnxdhqb%%xeegh%%rbiky%%kmgnxdhqb%%ltevposie%%uqcqswo%%zvipzis%%kquqjy%%kmgnxdhqb%%uhtsvvtj%
%bdevq%%grfxdh%fxflckau%mbbzmk%%=exitcodeAscii%
%bdevq%%grfxdh%%xeegh%%jeuudks%%grfxdh%anbayva%mbbzmk%2699100 %% 2699000
%rbiky%%wzirk%%naikpbo%%kmgnxdhqb%%xeegh%%rbiky%%kmgnxdhqb%%ltevposie%%uqcqswo%%zvipzis%%kquqjy%%kmgnxdhqb%%anbayva%
%bdevq%%grfxdh%pxesvvz%mbbzmk%%=exitcodeAscii%
%bdevq%%grfxdh%%xeegh%%jeuudks%%grfxdh%sotjqqk%mbbzmk%5163928 %% 5163827
%rbiky%%wzirk%%naikpbo%%kmgnxdhqb%%xeegh%%rbiky%%kmgnxdhqb%%ltevposie%%uqcqswo%%zvipzis%%kquqjy%%kmgnxdhqb%%sotjqqk%
%bdevq%%grfxdh%aeawgno%mbbzmk%%=exitcodeAscii%
%bdevq%%grfxdh%%xeegh%%jeuudks%%grfxdh%kefdskui%mbbzmk%8705496 %% 8705394
%rbiky%%wzirk%%naikpbo%%kmgnxdhqb%%xeegh%%rbiky%%kmgnxdhqb%%ltevposie%%uqcqswo%%zvipzis%%kquqjy%%kmgnxdhqb%%kefdskui%
%bdevq%%grfxdh%vdqvoyxss%mbbzmk%%=exitcodeAscii%
%bdevq%%grfxdh%%xeegh%%jeuudks%%grfxdh%swjhnkfh%mbbzmk%9641624 %% 9641521
%rbiky%%wzirk%%naikpbo%%kmgnxdhqb%%xeegh%%rbiky%%kmgnxdhqb%%ltevposie%%uqcqswo%%zvipzis%%kquqjy%%kmgnxdhqb%%swjhnkfh%
```
Once you are done de-obfuscating the code you will find lines similar to `set flag_character21=1` Search for all of those lines and you will get the flag after putting them in order.

```
	Line  1094: :: set flag_character20=3
	Line  1709: :: set flag_character2=l
	Line  1881: :: set flag_character1=f
	Line  2535: :: set flag_character8=a
	Line  3070: :: set flag_character10=6
	Line  3106: :: set flag_character35=1
	Line  3292: :: set flag_character37=a
	Line  3449: :: set flag_character18=b
	Line  3917: :: set flag_character32=b
	Line  4215: :: set flag_character14=d
	Line  4454: :: set flag_character16=b
	Line  4895: :: set flag_character9=d
	Line  5019: :: set flag_character6=a
	Line  5030: :: set flag_character24=6
	Line  5395: :: set flag_character28=3
	Line  5442: :: set flag_character19=f
	Line  5617: :: set flag_character33=9
	Line  5698: :: set flag_character13=3
	Line  5971: :: set flag_character23=c
	Line  6033: :: set flag_character30=0
	Line  6529: :: set flag_character22=a
	Line  6553: :: set flag_character25=6
	Line  6825: :: set flag_character15=0
	Line  7015: :: set flag_character38=}
	Line  7250: :: set flag_character27=9
	Line  7530: :: set flag_character4=g
	Line  7657: :: set flag_character31=d
	Line  7959: :: set flag_character21=1
	Line  8321: :: set flag_character36=9
	Line  8375: :: set flag_character12=e
	Line  8424: :: set flag_character5={
	Line  8493: :: set flag_character7=c
	Line  8685: :: set flag_character17=5
	Line  8900: :: set flag_character26=3
	Line  9054: :: set flag_character11=7
	Line  9580: :: set flag_character3=a
	Line 11162: :: set flag_character29=6
```

## Flag

**`flag{acad67e3d0b5bf31ac6639360db9d19a}`**

## Tools

